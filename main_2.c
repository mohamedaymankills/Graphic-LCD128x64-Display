
#include<avr/io.h>
#define F_CPU 8000000UL
#include<util/delay.h>

void glcd_picture(const unsigned char *);
void select_chip(int);

int i;

unsigned char photo[1024]={      0,  0,  0,  0,  0,128,  0,  0,  0,  0, 16,240,248,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,128,192,  0,  0,  0, 16,240,248,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	16, 56,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  2,  3,255,  2,  2,  2,  0,  0,255,255,  4,  2,  2,
	6,254,252,  0,  0, 96,248,148, 18, 18, 18, 22, 30, 24,  0,  2,
	6, 30,126,224,128,  0,192, 58,  6,  2,  0,  0,  0,  0,  0,  0,
	0,140,206, 66, 32, 34, 54,254,  0,  0,  0,  0,254,254,  4,  2,
	6,  6,  0,248,156, 18, 18, 18, 18, 30, 28,  0,  0,  0,  0,  0,
	0,  0,  2,  3,255,255,  2,  2,  0,  0,255,255,  4,  2,  2,  2,
	254,252,  0,  0,  0,248,148, 18, 18, 18, 22, 30, 28,  0,  0,  0,
	254,254,  0,  0,  0,  0,254,254,  4,  2,  6,  6,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  7,  6,  4,  0,  0,  0,  7,  7,  0,  0,  0,
	0,  7,  7,  0,  0,  0,  3,  7,  6, 12, 12,  4,  6,  1,  0,  0,
	192,192,192, 97, 31,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  7,  7, 12,  4,  4,  2,  7,  6,  4,  0,  0,  7,  7,  0,  0,
	0,  0,  0,  1,  7,  6, 14, 12,  4,  6,  3,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  7,  7,  4,  4,  0,  0,  7,  7,  0,  0,  0,  0,
	7,  7,  0,  0,  0,  3,  7,  6, 14, 12,  4,  6,  3,  0,  0,  0,
	7,  7,  4,  0,  0,  0,  7,  7,  4,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192,192,  0,  0,  0, 31,
	3,  3,  1,  1,  1,  1,  3,255,255,255,  1,  1,  1,  1,  1,  3,
	15,  0,  0,128,128,128,  0,128,128,128,128,  0,  0,  0,  0,  0,
	0,128,128,128,  0,  0,128,128,128,  0,  0,  0,  0,128,128,128,
	0,  0,128,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,
	128,192,128,128,128,  0,  0,  0,  0,128,192,224,248,128,128,128,
	128,  0,  0,  0,128,128,128,  0,128,128,128,128,  0,  0,  0,  0,
	0,  0,  0,  8,252,  8,  4, 12,  0,240,168,  4,  4,  4, 24, 16,
	0,152,220,  4, 36,252,248,  0,  0,  0,255,255,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,
	0,  0,143,207,193, 96, 32, 32, 16,255,255,255,  0,  0,  0,  1,
	1,255,255,255,  2,  1,  1,  1,  3,  1,  0, 60,127,255,193,  0,
	0,  0,  0,195,255,127, 29,  1,  1,  0,  0,252,254,  3,  0,  0,
	0,  0,  0, 11, 15, 15, 12,  0,  0,  0,  0,255,255,  0,  0,  0,
	0,  0,  0, 31, 63,120,112,240,224,224,193,135,  0,  0,  0,  0,
	0,  0,  0,  0,  3,  2,  0,  0,  0,  1,  3,  3,  6,  2,  2,  0,
	0,  3,  3,  2,  2,  3,  3,  2,  0,  0,  3,  3,  0,  0,  0,  0,
	0,  0,  0,  0, 32, 32, 56, 63, 63, 63, 32, 32,  0,  0,  0,  0,
	0, 15, 31, 63, 56, 48, 16, 16,  8, 31, 63, 63, 16, 24,  0, 32,
	32, 63, 63, 63, 48, 32,  0,  0,  0,  0,  0,136,124, 63, 57, 57,
	57, 57, 49, 48, 48, 48, 48,224,192,  0,  0,  7, 15, 31, 60, 56,
	56, 56, 56, 56, 24, 12,  3,  0,  0,  0,  0, 31, 63, 56, 48, 16,
	8,  0,  0, 62, 56, 48, 32, 32, 32, 33, 31, 31,  7,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  7, 15, 14, 12, 28, 24,
	24, 24, 24,  8,  8,  4,  6,  3,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
	0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0

	
};  //Your image pixels

void glcd_int();
void glcd_data(unsigned char);
void glcd_cmd(unsigned char);

void glcd_cmd(unsigned char cmd) //subroutine for command
{
	PORTC=cmd;
	_delay_ms(0);
	PORTD&=~(1<<2);
	PORTD&=~(1<<1);
	PORTD|=(1<<0);
	_delay_ms(0);
	PORTD&=~(1<<0);
}

void glcd_data(unsigned char dat)  //subroutine for data
{
	PORTC=dat;
	_delay_ms(0);
	PORTD|=(1<<2);
	PORTD&=~(1<<1);
	PORTD|=(1<<0);
	_delay_ms(0);
	PORTD&=~(1<<0);
}

void glcd_init()                //subroutine for initialaization
{
	unsigned char command[4]={0x10,0xb8,0x40,0x3f};
	select_chip(1);                      //Chip selection
	for(i=0;i<4;i++)
	glcd_cmd(command[i]);
	select_chip(0);
	for(i=0;i<4;i++)
	glcd_cmd(command[i]);
}

void select_chip(int chip)    //Chip selection
{
	if(chip==1)
	{
		PORTD|=(1<<4);
		PORTD&=~(1<<3);
	}
	else
	{
		PORTD&=~(1<<4);
		PORTD|=(1<<3);
	}
}

void glcd_picture(const unsigned char *ip)  //Subroutine for printing
{
	int page,column;
	for(page=0;page<8;page++)
	{
		select_chip(0);
		glcd_cmd(0xb8|page);
		glcd_cmd(0x40);
		for(column=0;column<128;column++)
		{
			if(column==64)
			{
				select_chip(1);
				glcd_cmd(0xb8|page);
				glcd_cmd(0x40);
			}
			glcd_data(*ip++);    //acessing array values using pointers
		}
	}
}

int main(void)
{
	DDRC=DDRD=0xff;
	_delay_ms(0);
	PORTD&=~(1<<5);
	_delay_ms(10);
	PORTD|=(1<<5);
	_delay_ms(0);
	
	while(1)
	{
		glcd_init();                    //initialization
		_delay_ms(0);
		glcd_picture(photo);      //Printing image pixels
		while(1);
	}
}
